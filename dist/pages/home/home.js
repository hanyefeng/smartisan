"use strict";require(["../../static/conf/config.js"],function(){require(["jquery","sw"],function(d,l){require(["../../scripts/common/common"],function(){if(getCookie("userinfo")){var e=JSON.parse(getCookie("userinfo")).username.replace(/(.{3}).*(.{4})/,"$1******$2");d(".nav-user-avatar dt").text("+86 "+e)}else;if("{}"!=localStorage.getItem("shoppingList")&&localStorage.getItem("shoppingList")){d("<span>").addClass("cart-tip").addClass("cart-num").appendTo(".nav-cart>a");var t=JSON.parse(localStorage.getItem("shoppingList")),o="";for(var s in t)o+=s+",";o=o.substr(0,o.length-1),d.ajax({url:"http://localhost:8000/goodinfo?id="+o,success:function(e){var o=JSON.parse(e).data.list;new fullShop(o,t,d(".nav-cart-list>div"))}})}else new EmptyShop(d(".nav-cart-list>div"));d(".nav-user").on("mouseenter",function(){getCookie("userinfo")&&d(".nav-user-wrapper").show()}).on("mouseleave",function(){d(".nav-user-wrapper").hide()}).on("click",function(){getCookie("userinfo")?location.href="http://localhost:9999/pages/home/home.html":location.href="http://localhost:9999/pages/login/login.html"}),d(".logout").on("click",function(){addCookie("userinfo","",-1),location.href="http://localhost:9999/pages/home/home.html"}),d(".nav-cart").on("mouseenter",function(){d(".nav-cart-wrapper").show()}).on("mouseleave",function(){d(".nav-cart-wrapper").hide()}),d(".nav-cart>a").on("click",function(){location.href="http://localhost:9999/pages/shoppingList/shoppingList.html"}),d(window).scroll(function(){100<=d(window).scrollTop()?(d("#nav-sub").addClass("fixed"),d("#nav-sub").css({padding:"16px 0"}),d("#nav-sub .search-bar").hide(),d("#nav-sub .nav-info").show(),d("#top .nav-info").hide()):(d("#nav-sub").removeClass("fixed"),d("#nav-sub").css({padding:"23px 0"}),d("#nav-sub .search-bar").show(),d("#nav-sub .nav-info").hide(),d("#top .nav-info").show())});var a=[];function n(){d(".result-list").empty();for(var e=0;e<a.length;e++){var o=d("<li>");d("<span>").text(a[e]).appendTo(o),o.appendTo(".result-list")}}function i(){d(".result-list").empty(),d.ajax({url:"http://localhost:8000/suggest?keyword="+d(".search-box").val(),success:function(e){var o=JSON.parse(e).data;if(0==o.length)d(".keywords-list").hide(),d(".search-recommend-words").hide();else{for(var t=0;t<o.length;t++){var s=d("<li>"),a=d("<span>").text(o[t]).appendTo(s),n=new RegExp("("+d(".search-box").val()+")","ig");a.html(a.html().replace(n,"<span style='color:#5079d9;font-weight:bold'>$1</span>")),s.appendTo(".result-list")}d(".keywords-list").show(),d(".search-recommend-words").hide()}}})}d.ajax({url:"http://localhost:8000/hotwords",success:function(e){a=JSON.parse(e).hot}});var r=!0;d(".search-box").on("focus",function(){""==d(".search-box").val()?n():i(),d(".keywords-list").show(),d(".search-recommend-words").hide(),d(this).attr("placeholder","请输入搜索的商品")}).on("blur",function(){d(".keywords-list").hide(),d(".search-recommend-words").show(),d(this).attr("placeholder","")}).on("input",throttle(function(){setTimeout(function(){r&&(""==d(".search-box").val()?(d(".keywords-list").show(),d(".search-recommend-words").hide(),n()):i())},1)},300)).on("compositionstart",function(){r=!1}).on("compositionend",function(){r=!0});new l(".swiper-container",{pagination:{el:".swiper-pagination",type:"bullets",clickable:!0},autoplay:!0,speed:1500,effect:"fade"});d(".home-page-arrow").on("click",function(e){if("home-page-arrow disable"==this.className)return;d(this).addClass("disable").siblings().removeClass("disable"),d(this).prevAll().length?d(".hot-items").css({transform:"translate(-1220px, 0px)"}):d(".hot-items").css({transform:"translate(0px, 0px)"})}),d.ajax({url:"http://localhost:8000/home",success:function(e){for(var o=JSON.parse(e),t=o.data.home_hot,s=0;s<t.length;s++)new GoodsItem(t[s],d(".hot-items")[0]);for(var a=o.data.home_floors[0].tabs[0].tab_items,n=1;n<a.length;n++)new GoodsItem(a[n],d(".brand-items")[0]);for(var i=o.data.home_floors[1].tabs[0].tab_items,r=1;r<i.length;r++)new GoodsItem(i[r],d(".phone-items")[0]);for(var l=o.data.home_floors[2].tabs[0].tab_items,c=1;c<i.length;c++)new GoodsItem(l[c],d(".official-items")[0]);var h=o.data.home_forum;d(".image-text-wrapper").children().each(function(e){d(this).children("div").children("img").attr("src",h[e].image),d(this).children("div").children("h5").text(h[e].title),d(this).children("div").children("p").text(h[e].subtitle),d(this).children("div").children("a").attr("href",h[e].link)})}})})})});